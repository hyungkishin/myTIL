### 의존성 관리의 중요성
의존성을 어떻게 관리하느냐에 따라서 설계가 어떻게 바뀌는지를 보여드리는 과정을 통해서 의존성을 어떻게 관리할 건지에 대한 힌트를 얻어가셨으면 좋겠음

### 설계의 개념
설계라고 하는 거는 코드를 어떻게 배치할 것인가에 대한 의사결정이라고 보시면 됨
의존성은 변경에 초점을 맞추는 게 가장 중요함
디펜던시는 변경에 의해서 영향을 받을 수 있는 가능성이라고 보시면 됨

### 상속 관계와 실체와 관계의 차이
상속 관계는 실체와 관계라고 하는데 실체와 관계의 차이는 상속 관계는 구현이 바뀌더라도 영향을 받을 수 있는 것이고 실체와 관계는 인터페이스의 오퍼레이션 시그니처가 바뀌었을 때만 영향을 받는 것임
패키지 사이의 의존관계의 종류를 살펴봤고 몇 가지 가이드가 있음

### 패키지의 의존성
양방향 연관관계가 필요한 경우도 있음
단방향 연관관계로 바꾸어야 함
다중성이 적은 방향을 선택해야 함
필요하면 제거해야 함
패키지 사이에는 의존성의 사이클이 생기지 않도록 해야 함

### 가게의 메뉴
가게는 여러 개의 메뉴가 있고 메뉴 옵션 그룹 옵션이라고 하는 도메인 개념으로 묶여 있음
가게에 메뉴가 붙어 있고 옵션 그룹이 3개가 있음
옵션 그룹에 300g이라고 하는 옵션들이 런타임에 붙어 있는 구조임

### 주문과 메뉴의 관계
주문은 어떤 가게에 대해서 주문을 하는 것임
주문에는 아까 말씀드린 것처럼 주문 항목이나 주문 옵션으로 주문이 붙을 거고 메뉴도 어떤 가게에 속해 있는 메뉴임
가게라는 거를 중심으로 해서 메뉴와 주문이 런타임의 객체들의 관계가 엮임
주문이 발생을 할 때마다 실제로 주문이 전송되는 데이터랑 사장님이 등록하신 데이터가 일치하는지를 검증을 해야 됨

### 밸리데이션의 로직
옵션 그룹의 이름, 옵션의 이름과 가격을 비교를 해야 됨
최소 주문 금액이 만족하는지도 살펴봐야 함
최소 주문 금액을 내가 요청한 게 넘어섰는지를 확인을 해야 됨
주문이 일어나는데 밸리데이션을 하는 로직의 협력을 설계해 보겠음

### 동적인 구조의 개발
클래스라면 의존성의 관점에서 설계를 살펴봐야 함
동적인 구조를 개발이라고 하는 건 변화무쌍한 가능성들을 다 정적인 코드로 담아야 함
관계라고 하는 건 어떤 객체가 어떤 식으로 의존을 할 거야라고 하는 걸 실제 코드상의 정적인 부분으로 그려줘야 됨

### 의존성
어떤 메소드에 파라미터를 넣거나 할 때마다 어떤 의사결정을 하는 거냐면 타입의 객체와 원 타임에 협력할 거야라는 의사결정을 하는 것임
관계라고 하는 거는 항상 객체에서 방향성이 필요함
의존성이라고 하는 거는 어떤 애가 어떤 애한테 의존해라는 게 있음

### 연관관계의 정의
연관관계는 탐색 가능성을 정의함
의존관계는 일시적인 것임
연관관계를 잡는 건 두 객체 간의 통로가 굉장히 영구적으로 유지가 되어야 해라고 하는 판단 근거가 있어야 함

### 주문하기의 협력
주문하기의 협력은 오더라고 하는 객체에 주문하기라고 하는 메시지가 도착했을 때 시작함
어떤 객체가 어떤 메시지를 받는다는 거는 그 객체의 퍼블릭 메서드로 구현이 됨
오더라고 하는 클래스의 객체를 만들고 플레이스라고 하는 메시지를 보내야 됨

### 주문 메소드
주문이 올바른지를 검증하는 메소드와 주문의 상태를 바꾸는 메소드 두 가지 메소드로 구성이 되어 있음
주문이라는 게 있는데 주문 안에는 항상 주문 항목이 있음
강력한 관계이기 때문에 메시지의 경로로 연관관계를 설정을 했고 연관관계를 구현하기 위해서 객체 참조를 사용함

### 샵의 주문 검증
가게가 영업 중인지 확인하고 주문 금액이 최소 주문 금액 이상인지 확인하기 위해서 샵 쪽에 메시지를 보냄
주문이 통과 가능한 건지를 검증을 하고 각각의 주문 항목들이 매칭이 되는지 데이터가 바뀌지 않았는지를 판단해줘야 함

### 오더 라인 아이템의 역할
오더 라인 아이템이 메뉴로 메시지를 보내는데 파라미터로 자기 자신을 넘김
메뉴의 이름이랑 주문 항목의 이름이 같은지를 메뉴에서 비교를 함
옵션 그룹 쪽에서 각각의 항목에 대해서 같은 지를 비교를 함
전체적으로 각각의 코드는 나중에 제가 기터에 있는 코드를 보시면 될 것 같음

### 설계 개선 방법
설계를 개선을 시켜야 됨
설계를 개선을 어떻게 해야 되냐라고 여쭤보시면 디펜던시가 어떻게 돼요를 보세요라고 말씀드림
디펜던시를 그려봤을 때 찝찝한 부분이 보이면 설계를 어떻게 개선을 해야 되는지에 대한 그림이 보임

### 패키지의 의존성
패키지에 의존성이 사이클을 돌 때의 문제점을 해결하는 관점에서 설명을 하도록 하겠음
서비스와 도메인이라고 하는 레이어를 패키지로 구현해서 나눠놓은 거고요. 그 안에 객체들을 위치시킨 다음에 객체들 사이에 디펜던시를 그려봤더니 이런 모양이 나옴
오더 쪽에 있는 오더 옵션 그룹이나 오더 옵션을 고칠 때 옵션 그룹 스페스케이션도 고쳐야 됨
오더 쪽에서 샵 쪽으로 디펜던시가 흐름

### 옵션 그룹의 정의
옵션 그룹 스펙과 오더 옵션 그룹보다는 옵션 그룹에 필요한 데이터만 들고 있음
클래스로 구현을 했을 뿐이지 얘는 두 개의 클래스보다는 더 추상적인 레벨에서 구현이 됨
디펜던시를 구체적인 클래스이긴 하지만 끊음으로써 재사용성이 증가함

### 연관관계의 구현
디펜던시를 보면서 설계를 개선할 수 있는 포인트가 있지 않을까 하는 부분들을 봐주면 됨
연관관계는 어떤 객체에서 어떤 객체로 탐색할 수 있는 것임
연관관계를 구현을 하면 다양한 이슈들이 발생함

### 트랜잭션의 경계
객체 참조를 통해서 수정하고 있는 모든 것들이 트랜잭션 안에서 하나의 트랜잭션으로 확 가버림
트랜잭션의 경계도 굉장히 모호해짐
비즈니스 로직이 추가될수록 상태를 바꿔야 되는 객체들은 계속 추가가 됨
요구 사항이 추가될수록 트랜션은 점점 길어짐

### 객체 참조의 욕망
객체 참조는 모든 걸 다 연결시켜버림
객체 참조가 연결되어 있다 보니까 그냥 저 객체 참조에 객체를 하나 걸어서 다 쫓아가고 싶어지는 욕망이 생김
객체 참조는 모든 객체를 다 연결을 시켜버림
필요한 경우에는 객체 참조를 다 끊어버려야 함

### 연관관계 구현 방법
오더 안에 샵이라고 하는 인스턴스 변수를 박아서 그 인스턴스 변수를 통해서 탐색을 하는 것임
연관관계를 구현할 수 있는 방법으로 리파지토리를 사용함
리파지토리에 들어가는 인터페이스는 연관관계를 구현할 수 있는 오퍼레이션들이 들어가야 함
비즈니스 로직은 단방향으로 깔끔하게 만들 수 있지만 조회 로직이나 어드민 로직을 넣다 보면 양방향 관계가 갑자기 늘어남

### 도메인 컨스트 공유
도메인적으로 제약 사항을 같이 공유하는 애들은 다 묶어줘야 함
그렇지 않은 애들은 바뀔 때 굳이 같이 안 바뀌어도 되면 끊어주면 됨
장바구니와 장바구니 항목을 하나의 단위로 묶을 거야 말 거야를 고민을 많이 했는데 장바구니가 생성되는 시점과 장바구니가 넣는 시점은 라이프 사이클이 다르기 때문에 도메인 컨스트를 공유하지 않음
비즈니스 룰에 따라서 결정이 됨

### 객체 지향 자료의 특징
객체 지향 자료를 설명하기 위해서는 객체 참조를 쓰고 객체 참조를 통해서 메시지를 주고받거나 이런 것들이 굉장히 설명하기가 편함
이론을 설명하기 위한 것과 실무로 가지고 있을 때 연관관계라고 하는 개념은 같지만 실제로 구현을 할 때는 달라짐

### db의 트랜션 단위
도큐먼트 db 같은 경우는 객체로 한 방에 들어가는 거라서 조회 단위가 됨
몽고 디비나 이런 쪽은 자연스럽게 한 번에 가져오는 거임
몽고 db 는 데이터를 한 번에 써야 되는데 그 얘기는 db의 트랜션 단위가 됨

### 객체의 결합도를 높이는 방법
객체 안에 밸리데이션 로직을 다 넣어야 된다고 강박 관념을 갖고 있음
객체의 상태를 밸리데이션을 하기 위해서 여러 객체들을 다 참조해야 됨
객체의 결합도를 높이지만 객체의 응집도는 낮출 수가 있음

### 도메인 로직의 의존성
도메인 로직이 순차적으로 실행이 되는 경우에 어떻게 끊어야 되는지 두 가지 방법을 설명함
도메인 로직이 순차적으로 실행이 되는 경우에 의존성을 그려봐야 함

### 도메인 이벤트
의존성이 사이클을 돌기 때문에 인터페이스를 사용해서 의존성을 역전시키면 됨
도메인 이벤트는 서비스에 대한 개념으로 로직 간에 a라는 게 끝났을 때 bc가 실행됐으면 좋겠다는 동기임
도메인 이벤트는 메모리 상에서 돌아가는 거라고 보면 됨

### 도메인 이벤트
도메인 이벤트를 사용해서 로직의 순서를 처리하는 방법을 설명하고 있음
도메인 이벤트를 구현하기 쉬운 방법으로 스프링 데이터에서 제공하는 추상 클래스를 상속받아서 넣었음
스프링 데이터에서 제공하는 레지스터 이벤트라고 하는 메소드를 제공을 해줌
원하는 이벤트를 레지스터 하면 커밋을 할 때 이벤트를 발행해 줌

### 패키지의 개념
패키지를 찢어낼 때는 도메인적으로 되게 명확한 뭔가 새로운 개념이 필요함
그게 우리는 정산인 것 같음
패키지를 찢어내는 게 좋겠어라고 하는 의사결정에 의해서 찢어내는 것임
의존성을 관리를 하다 보면 시스템을 쉽게 분리할 수가 있음